-- The just ratios!
let rTo12 f = (*12) $ log (fromRational f) / log 2 
rTo12 $ 8/7 -- wanted to def&use rnd x = round (100*x)/100; fails
let octave1 n = if n<= 0 then n else if n<1 then octave1 (n*2) else if n>2 then octave1 (n/2) else n
let theFirstRatios = nub $ fmap octave1 $ (%)<$>[1..16]<*>[1..16]
fmap (\r -> (octave1 r, rTo12 $ fromRational  r)) theFirstRatios
  -- for 16 X 16 there are only 50 ratios!

-- standardize a set of ratios! almost works!
  -- so that for instance stdz [1/3,2/3] = [3,2]
  -- problem: stdz [13+1%3,14] = [40.0,42.0], should be [20.0,21.0]
let lcmMany' (acc,list) = case list of [] -> acc; h:t -> lcmMany' (lcm acc h, t)
let lcmMany integrals = lcmMany' (1,integrals)
let stdz ratios = fromRational . (*(fromIntegral lcm)) <$> ratios       where lcm = lcmMany $ denominator <$> ratios
  -- Result: [(1 % 1,0.0),(4 % 3,4.980449991346124),(8 % 5,8.136862861351654),(8 % 7,2.31174093530875),(16 % 9,9.96089998269225),(16 % 11,6.486820576352434),(16 % 13,3.594723382306895),(16 % 15,1.1173128526977776),(2 % 1,12.0),(3 % 2,7.019550008653875),(6 % 5,3.1564128700055254),(12 % 7,9.331290943962623),(12 % 11,1.5063705850063058),(24 % 13,10.614273390960768),(5 % 4,3.863137138648348),(5 % 3,8.843587129994475),(10 % 7,6.174878073957099),(10 % 9,1.8240371213406008),(20 % 11,10.34995771500078),(20 % 13,7.4578605209552435),(7 % 4,9.688259064691248),(7 % 6,2.6687090560373763),(7 % 5,5.8251219260429),(14 % 9,7.649159047383502),(14 % 11,4.1750796410436815),(14 % 13,1.2829824469981428),(28 % 15,10.805571917389027),(9 % 8,2.0391000173077485),(9 % 5,10.175962878659401),(9 % 7,4.350840952616501),(18 % 11,8.525920593660183),(18 % 13,5.633823399614642),(11 % 8,5.513179423647567),(11 % 6,10.493629414993691),(11 % 10,1.6500422849992202),(11 % 7,7.824920358956318),(11 % 9,3.4740794063398206),(22 % 13,9.107902805954462),(22 % 15,6.630492276345343),(13 % 8,8.405276617693106),(13 % 12,1.3857266090392306),(13 % 10,4.542139479044758),(13 % 7,10.71701755300186),(13 % 9,6.366176600385358),(13 % 11,2.8920971940455398),(26 % 15,9.522589470390884),(15 % 8,10.88268714730222),(15 % 14,1.1944280826109726),(15 % 11,5.369507723654654),(15 % 13,2.4774105296091147)]

