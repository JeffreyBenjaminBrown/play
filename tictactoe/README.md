Jake Brownson wrote this and posted it here:
  https://gist.github.com/jbrownson/712ddafd1cb3388cd827
I mostly just added comments.


